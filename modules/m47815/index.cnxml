<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML">
  <title>Least Squares Estimation in Hilbert Spaces</title>
<metadata xmlns:md="http://cnx.rice.edu/mdml">
  <md:content-id>m47815</md:content-id>
  <md:title>Least Squares Estimation in Hilbert Spaces</md:title>
  <md:abstract>Presents leasts squares estimation in subspaces of Hilbert spaces, with applications.</md:abstract>
  <md:uuid>72098065-2cc6-415f-ad82-708bcccb05d1</md:uuid>
</metadata>

<content>
    <section id="cid1">
      <title>Projections with Orthonormal Bases</title>
      <para id="id76298">Having an orthonormal basis for the subspace of interest significantly simplifies the projection operator.</para>
      <para id="id76302"><emphasis effect="bold">Lemma 1</emphasis> Let <m:math overflow="scroll"><m:mrow><m:mi>x</m:mi><m:mo>∈</m:mo><m:mi>X</m:mi></m:mrow></m:math>, a Hilbert space, and let <m:math overflow="scroll"><m:mi>S</m:mi></m:math> be a subspace of <m:math overflow="scroll"><m:mi>X</m:mi></m:math>. If <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>b</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>b</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>}</m:mo></m:mrow></m:math> is an orthonormal basis for <m:math overflow="scroll"><m:mi>S</m:mi></m:math>, then the closest point <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>∈</m:mo><m:mi>S</m:mi></m:mrow></m:math> to <m:math overflow="scroll"><m:mi>x</m:mi></m:math> is given by <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:msub><m:mo>∑</m:mo><m:mi>i</m:mi></m:msub><m:mrow><m:mo>〈</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub><m:mo>〉</m:mo></m:mrow><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>.</para>
      <para id="id76241">We begin by noting that</para>
      <equation id="uid2">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mi>i</m:mi>
                  </m:munder>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>b</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>b</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mi>i</m:mi>
                  </m:munder>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>-</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                    <m:mo>+</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>b</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>b</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mi>i</m:mi>
                  </m:munder>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>-</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>b</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>b</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>+</m:mo>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mi>i</m:mi>
                  </m:munder>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>b</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>b</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id77184">
Now, since <m:math overflow="scroll"><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub></m:math> is the projection of <m:math overflow="scroll"><m:mi>x</m:mi></m:math> onto <m:math overflow="scroll"><m:mi>S</m:mi></m:math>, we must have that <m:math overflow="scroll"><m:mrow><m:mi>x</m:mi><m:mo>-</m:mo><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>⊥</m:mo><m:mi>S</m:mi></m:mrow></m:math>, and so for each basis element <m:math overflow="scroll"><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub></m:math> we must have <m:math overflow="scroll"><m:mrow><m:mo>〈</m:mo><m:mi>x</m:mi><m:mo>-</m:mo><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub><m:mo>〉</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>. Additionally, since <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>∈</m:mo><m:mi>S</m:mi></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>b</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>b</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>}</m:mo></m:mrow></m:math> is an orthonormal basis for <m:math overflow="scroll"><m:mi>S</m:mi></m:math>, we must have that <m:math overflow="scroll"><m:mrow><m:msub><m:mo>∑</m:mo><m:mi>i</m:mi></m:msub><m:mrow><m:mo>〈</m:mo><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub><m:mo>〉</m:mo></m:mrow><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub></m:mrow></m:math>. Thus, we obtain</para>
      <equation id="uid3">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mi>i</m:mi>
                  </m:munder>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>b</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>b</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mn>0</m:mn>
                  </m:msub>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id77469">
proving the lemma.</para>
    </section>
    <section id="cid2">
      <title>Application: Communications Receiver</title>
      <para id="id77484">Consider the case of a communications receiver that records a continuous-time signal <m:math overflow="scroll"><m:mrow><m:mi>r</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>s</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo><m:mo>+</m:mo><m:mi>n</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math> over <m:math overflow="scroll"><m:mrow><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>t</m:mi><m:mo>≤</m:mo><m:mn>1</m:mn></m:mrow></m:math>, where <m:math overflow="scroll"><m:mrow><m:mi>s</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math> is one of <m:math overflow="scroll"><m:mi>m</m:mi></m:math> codeword signals <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>s</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>s</m:mi><m:mi>m</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>, and <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math> is additive white Gaussian noise. The receiver must make the best possible decision on the observed codeword given the reading <m:math overflow="scroll"><m:mrow><m:mi>r</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math>; this usually involves removing as much of the noise as possible from <m:math overflow="scroll"><m:mrow><m:mi>r</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math>.</para>
      <para id="id77660">We analyze this problem in the context of the Hilbert space <m:math overflow="scroll"><m:mrow><m:msub><m:mi>L</m:mi><m:mn>2</m:mn></m:msub><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>]</m:mo></m:mrow></m:mrow></m:math>. To remove as much of the noise as possible, we define the subspace <m:math overflow="scroll"><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:mi> span </m:mi><m:mo>(</m:mo><m:mrow><m:mo>{</m:mo><m:msub><m:mi>s</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>s</m:mi><m:mi>m</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:math>. Anything that is not contained in this subspace is guaranteed to be part of the noise <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math>. Now, to obtain the projection into <m:math overflow="scroll"><m:mi>S</m:mi></m:math>, we need to find an orthonormal basis <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>e</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>e</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> for <m:math overflow="scroll"><m:mi>S</m:mi></m:math>, which can be done for example by applying the Gram-Schmidt procedure on the vectors <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>s</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>s</m:mi><m:mi>m</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>. The projection is then obtained according to the lemma as</para>
      <equation id="uid4">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msub>
                    <m:mi>r</m:mi>
                    <m:mi>S</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>r</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>e</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>e</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id77984">
where <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>〈</m:mo><m:mi>r</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:msub><m:mi>e</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>〉</m:mo></m:mrow><m:mo>=</m:mo><m:msubsup><m:mo>∫</m:mo><m:mn>0</m:mn><m:mn>1</m:mn></m:msubsup><m:mi>r</m:mi><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>e</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mi>d</m:mi><m:mi>t</m:mi></m:mrow></m:math>.</para>
      <para id="id78070">After the projection is obtained, an optimal receiver proceeds by finding the value of <m:math overflow="scroll"><m:mi>k</m:mi></m:math> that minimizes the distance</para>
      <equation id="uid5">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msub>
                    <m:mi>d</m:mi>
                    <m:mn>2</m:mn>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>r</m:mi>
                      <m:mi>S</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:msubsup>
                    <m:mo>∫</m:mo>
                    <m:mn>0</m:mn>
                    <m:mn>1</m:mn>
                  </m:msubsup>
                  <m:msup>
                    <m:mrow>
                      <m:mo>|</m:mo>
                      <m:msub>
                        <m:mi>r</m:mi>
                        <m:mi>S</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>s</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>|</m:mo>
                    </m:mrow>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>d</m:mi>
                  <m:mi>t</m:mi>
                  <m:mo>=</m:mo>
                  <m:msubsup>
                    <m:mo>∫</m:mo>
                    <m:mn>0</m:mn>
                    <m:mn>1</m:mn>
                  </m:msubsup>
                  <m:msub>
                    <m:mi>r</m:mi>
                    <m:mi>S</m:mi>
                  </m:msub>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>d</m:mi>
                  <m:mi>t</m:mi>
                  <m:mo>+</m:mo>
                  <m:msubsup>
                    <m:mo>∫</m:mo>
                    <m:mn>0</m:mn>
                    <m:mn>1</m:mn>
                  </m:msubsup>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>d</m:mi>
                  <m:mi>t</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>2</m:mn>
                  <m:msubsup>
                    <m:mo>∫</m:mo>
                    <m:mn>0</m:mn>
                    <m:mn>1</m:mn>
                  </m:msubsup>
                  <m:msub>
                    <m:mi>r</m:mi>
                    <m:mi>S</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mn>2</m:mn>
                  <m:mi>d</m:mi>
                  <m:mi>t</m:mi>
                  <m:mo>;</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id78339">
note here that the first term does not depend on <m:math overflow="scroll"><m:mi>k</m:mi></m:math>, so it suffices to find the value of <m:math overflow="scroll"><m:mi>k</m:mi></m:math> that minimizes the “cost”</para>
      <equation id="uid6">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>k</m:mi>
                </m:msub>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>:</m:mo>
                  <m:mo>=</m:mo>
                  <m:msubsup>
                    <m:mo>∫</m:mo>
                    <m:mn>0</m:mn>
                    <m:mn>1</m:mn>
                  </m:msubsup>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>d</m:mi>
                  <m:mi>t</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>2</m:mn>
                  <m:msubsup>
                    <m:mo>∫</m:mo>
                    <m:mn>0</m:mn>
                    <m:mn>1</m:mn>
                  </m:msubsup>
                  <m:msub>
                    <m:mi>r</m:mi>
                    <m:mi>S</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mn>2</m:mn>
                  <m:mi>d</m:mi>
                  <m:mi>t</m:mi>
                  <m:mo>=</m:mo>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mo>-</m:mo>
                  <m:mn>2</m:mn>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>r</m:mi>
                      <m:mi>S</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mo>-</m:mo>
                  <m:mn>2</m:mn>
                  <m:mfenced separators="" open="〈" close="〉">
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>n</m:mi>
                    </m:munderover>
                    <m:mrow>
                      <m:mo>〈</m:mo>
                      <m:mi>r</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>,</m:mo>
                      <m:msub>
                        <m:mi>e</m:mi>
                        <m:mi>i</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>〉</m:mo>
                    </m:mrow>
                    <m:msub>
                      <m:mi>e</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mo>-</m:mo>
                  <m:mn>2</m:mn>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>r</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>e</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>e</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id78838">
In practice, the codeword signals are designed so that their norms <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>∥</m:mo></m:mrow><m:msub><m:mi>s</m:mi><m:mi>k</m:mi></m:msub><m:msub><m:mrow><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>∥</m:mo></m:mrow><m:mn>2</m:mn></m:msub><m:mo>=</m:mo><m:msqrt><m:mrow><m:mo>〈</m:mo><m:msub><m:mi>s</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:msub><m:mi>s</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mo>〉</m:mo></m:mrow></m:msqrt></m:mrow></m:math> are all equal. This design choice reduces the problem above to finding the value of <m:math overflow="scroll"><m:mi>k</m:mi></m:math> that maximizes the score</para>
      <equation id="uid7">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:msubsup>
                  <m:mi>c</m:mi>
                  <m:mi>k</m:mi>
                  <m:mo>'</m:mo>
                </m:msubsup>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>:</m:mo>
                  <m:mo>=</m:mo>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:mi>r</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>e</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mo>〈</m:mo>
                    <m:msub>
                      <m:mi>e</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>〉</m:mo>
                  </m:mrow>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id79052">
Thus, the receiver can be designed according to the diagram in <link target-id="uid8"/>.</para>
      <figure id="uid8">
        <media id="uid8_media" alt="">
          <image mime-type="image/png" src="../../media/comm_receiver.png" id="uid8_onlineimage" width="954"><!-- NOTE: attribute width changes image size online (pixels). original width is 954. --></image>
          <image mime-type="application/postscript" for="pdf" src="../../media/comm_receiver.eps" id="uid8_printimage" print-width="15.0cm">
            <!--NOTE: attribute width changes image size in printed PDF (if specified in .tex file)-->
          </image>
        </media>
        <caption>Diagram of a communications receiver designed in accordance with the projection theorem.</caption>
      </figure>
    </section>
    <section id="cid3">
      <title>Least Squares Approximation in Hilbert Spaces</title>
      <para id="id79086">Let <m:math overflow="scroll"><m:mrow><m:msub><m:mi>y</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>u</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math> be elements of a Hilbert space <m:math overflow="scroll"><m:mi>X</m:mi></m:math> and define the closed, finite-dimensional subspace of <m:math overflow="scroll"><m:mi>X</m:mi></m:math> given by <m:math overflow="scroll"><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:mi> span </m:mi><m:mo>(</m:mo><m:msub><m:mi>y</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:math>. We wish to find the best approximation of <m:math overflow="scroll"><m:mi>x</m:mi></m:math> in terms of the vectors <m:math overflow="scroll"><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:math>, that is, the linear combination <m:math overflow="scroll"><m:mrow><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math> with the smallest error <m:math overflow="scroll"><m:mrow><m:mi>e</m:mi><m:mo>=</m:mo><m:mi>x</m:mi><m:mo>-</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>. To measure the size of the error, we use the induced norm <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>∥</m:mo><m:mi>e</m:mi><m:mo>∥</m:mo></m:mrow><m:mo>=</m:mo><m:mfenced separators="" open="∥" close="∥"><m:mi>x</m:mi><m:mo>-</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:mfenced></m:mrow></m:math>.</para>
      <para id="id79340">To solve this problem, we rely on the projection theorem: we are indeed looking for the closest point to <m:math overflow="scroll"><m:mi>x</m:mi></m:math> in <m:math overflow="scroll"><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:mi> span </m:mi><m:mo>(</m:mo><m:msub><m:mi>y</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:math>. The projection theorem tells us that the closest point <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math> must give <m:math overflow="scroll"><m:mrow><m:mi>x</m:mi><m:mo>-</m:mo><m:msub><m:mi>s</m:mi><m:mn>0</m:mn></m:msub><m:mo>⊥</m:mo><m:mi>S</m:mi></m:mrow></m:math>, i.e., <m:math overflow="scroll"><m:mrow><m:mi>e</m:mi><m:mo>⊥</m:mo><m:mi>S</m:mi></m:mrow></m:math>, which implies in turn that <m:math overflow="scroll"><m:mrow><m:mfenced separators="" open="〈" close="〉"><m:mi>x</m:mi><m:mo>-</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>j</m:mi></m:msub></m:mfenced><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> for all <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>n</m:mi></m:mrow></m:math>. The requirement can be rewritten as <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>〈</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>j</m:mi></m:msub><m:mo>〉</m:mo></m:mrow><m:mo>=</m:mo><m:mfenced separators="" open="〈" close="〉"><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>j</m:mi></m:msub></m:mfenced><m:mo>=</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>〈</m:mo><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>j</m:mi></m:msub><m:mo>〉</m:mo></m:mrow></m:mrow></m:math> for each <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>n</m:mi></m:mrow></m:math>. These requirements can be collected and written in matrix form as</para>
      <equation id="uid9">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:munder>
                    <m:munder accentunder="true">
                      <m:mfenced open="[" close="]">
                        <m:mtable>
                          <m:mtr>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:mi>x</m:mi>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:mi>x</m:mi>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>2</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mo>⋮</m:mo>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:mi>x</m:mi>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                          </m:mtr>
                        </m:mtable>
                      </m:mfenced>
                      <m:mo>︸</m:mo>
                    </m:munder>
                    <m:mi>β</m:mi>
                  </m:munder>
                  <m:mo>=</m:mo>
                  <m:munder>
                    <m:munder accentunder="true">
                      <m:mfenced open="[" close="]">
                        <m:mtable>
                          <m:mtr>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>2</m:mn>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                            <m:mtd>
                              <m:mo>⋯</m:mo>
                            </m:mtd>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>2</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>2</m:mn>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>3</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                            <m:mtd>
                              <m:mo>⋯</m:mo>
                            </m:mtd>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>2</m:mn>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mo>⋮</m:mo>
                            </m:mtd>
                            <m:mtd>
                              <m:mo>⋮</m:mo>
                            </m:mtd>
                            <m:mtd>
                              <m:mo>⋱</m:mo>
                            </m:mtd>
                            <m:mtd>
                              <m:mo>⋮</m:mo>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>1</m:mn>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mn>2</m:mn>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                            <m:mtd>
                              <m:mo>⋯</m:mo>
                            </m:mtd>
                            <m:mtd>
                              <m:mfenced separators="" open="〈" close="〉">
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                                <m:mo>,</m:mo>
                                <m:msub>
                                  <m:mi>y</m:mi>
                                  <m:mi>n</m:mi>
                                </m:msub>
                              </m:mfenced>
                            </m:mtd>
                          </m:mtr>
                        </m:mtable>
                      </m:mfenced>
                      <m:mo>︸</m:mo>
                    </m:munder>
                    <m:mi>G</m:mi>
                  </m:munder>
                  <m:munder>
                    <m:munder accentunder="true">
                      <m:mfenced open="[" close="]">
                        <m:mtable>
                          <m:mtr>
                            <m:mtd>
                              <m:msub>
                                <m:mi>a</m:mi>
                                <m:mn>1</m:mn>
                              </m:msub>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:msub>
                                <m:mi>a</m:mi>
                                <m:mn>2</m:mn>
                              </m:msub>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:mo>⋮</m:mo>
                            </m:mtd>
                          </m:mtr>
                          <m:mtr>
                            <m:mtd>
                              <m:msub>
                                <m:mi>a</m:mi>
                                <m:mi>n</m:mi>
                              </m:msub>
                            </m:mtd>
                          </m:mtr>
                        </m:mtable>
                      </m:mfenced>
                      <m:mo>︸</m:mo>
                    </m:munder>
                    <m:mi>a</m:mi>
                  </m:munder>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id80160">
The coefficients of the best approximation can then be obtained as a vector <m:math overflow="scroll"><m:mrow><m:mi>a</m:mi><m:mo>=</m:mo><m:msup><m:mi>G</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mi>β</m:mi></m:mrow></m:math>, as long as the Gram matrix <m:math overflow="scroll"><m:mi>G</m:mi></m:math> is invertible, i.e., it has a nonzero determinant.</para>
      <para id="id80201">In the case that <m:math overflow="scroll"><m:mi>x</m:mi></m:math> and <m:math overflow="scroll"><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:math> are complex-valued vectors, one can rewrite the approximation <m:math overflow="scroll"><m:mrow><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mi>Y</m:mi><m:mi>a</m:mi></m:mrow></m:math>, where <m:math overflow="scroll"><m:mi>a</m:mi></m:math> is the coefficient vector denoted above and <m:math overflow="scroll"><m:mrow><m:mi>Y</m:mi><m:mo>=</m:mo><m:mo>[</m:mo><m:msub><m:mi>y</m:mi><m:mn>1</m:mn></m:msub><m:mspace width="3.33333pt"/><m:mo>...</m:mo><m:mspace width="3.33333pt"/><m:msub><m:mi>y</m:mi><m:mi>n</m:mi></m:msub><m:mo>]</m:mo></m:mrow></m:math> is a matrix that collects the vectors <m:math overflow="scroll"><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:math> as its columns. The projection theorem requirement then becomes <m:math overflow="scroll"><m:mrow><m:mo>〈</m:mo><m:mi>x</m:mi><m:mo>-</m:mo><m:mi>M</m:mi><m:mi>a</m:mi><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>j</m:mi></m:msub><m:mo>〉</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>n</m:mi></m:mrow></m:math>, which can be rewritten as <m:math overflow="scroll"><m:mrow><m:msubsup><m:mi>y</m:mi><m:mi>j</m:mi><m:mi>H</m:mi></m:msubsup><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>-</m:mo><m:mi>M</m:mi><m:mi>a</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> and collected as before into the matrix equation</para>
      <equation id="uid10">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>M</m:mi>
                  <m:msup>
                    <m:mi>j</m:mi>
                    <m:mi>H</m:mi>
                  </m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>-</m:mo>
                    <m:mi>M</m:mi>
                    <m:mi>a</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mn>0</m:mn>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>H</m:mi>
                  </m:msup>
                  <m:mi>x</m:mi>
                  <m:mo>-</m:mo>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>H</m:mi>
                  </m:msup>
                  <m:mi>M</m:mi>
                  <m:mi>a</m:mi>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mn>0</m:mn>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>H</m:mi>
                  </m:msup>
                  <m:mi>M</m:mi>
                  <m:mi>a</m:mi>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>H</m:mi>
                  </m:msup>
                  <m:mi>x</m:mi>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mi>a</m:mi>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msup>
                        <m:mi>M</m:mi>
                        <m:mi>H</m:mi>
                      </m:msup>
                      <m:mi>M</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mrow>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msup>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>H</m:mi>
                  </m:msup>
                  <m:mi>x</m:mi>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mo>†</m:mo>
                  </m:msup>
                  <m:mi>x</m:mi>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id80621">
which is known as the least squares solution and exists as long as <m:math overflow="scroll"><m:mrow><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>M</m:mi></m:mrow></m:math> is an invertible matrix. Once these coefficients are obtained, the approximation is equal to <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>x</m:mi><m:mo>^</m:mo></m:mover><m:mo>=</m:mo><m:mi>M</m:mi><m:mi>a</m:mi><m:mo>=</m:mo><m:mi>M</m:mi><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>M</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>x</m:mi></m:mrow></m:math>; therefore, the matrix <m:math overflow="scroll"><m:mrow><m:msub><m:mi>P</m:mi><m:mi>M</m:mi></m:msub><m:mo>=</m:mo><m:mi>M</m:mi><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>M</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup></m:mrow></m:math> is known as the projection operator.</para>
    </section>
    <section id="cid4">
      <title>Application: Channel Equalization</title>
      <para id="id80767">We consider a linear channel with impulse response <m:math overflow="scroll"><m:mi>h</m:mi></m:math> that maps an input <m:math overflow="scroll"><m:mi>x</m:mi></m:math> into an output <m:math overflow="scroll"><m:mi>y</m:mi></m:math>:
</para>
      <equation id="id80812">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>x</m:mi>
            <m:mo>→</m:mo>
            <m:mi>h</m:mi>
            <m:mo>→</m:mo>
            <m:mi>y</m:mi>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id80835">We wish to design a linear equalizer of impulse response <m:math overflow="scroll"><m:mi>g</m:mi></m:math> for the input <m:math overflow="scroll"><m:mi>x</m:mi></m:math> so that after it is run through the equalizer and the channel of impulse response <m:math overflow="scroll"><m:mi>h</m:mi></m:math> the output <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>≈</m:mo><m:mi>x</m:mi></m:mrow></m:math> (i.e., <m:math overflow="scroll"><m:mi>f</m:mi></m:math> is as close as possible to <m:math overflow="scroll"><m:mi>x</m:mi></m:math>):
</para>
      <equation id="id80929">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>x</m:mi>
            <m:mo>→</m:mo>
            <m:mi>g</m:mi>
            <m:mo>→</m:mo>
            <m:mi>h</m:mi>
            <m:mo>→</m:mo>
            <m:mi>f</m:mi>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id80957">Since the equalizer is linear, the order of <m:math overflow="scroll"><m:mi>g</m:mi></m:math> and <m:math overflow="scroll"><m:mi>h</m:mi></m:math> can be reversed (this will be discussed in more detail later):
</para>
      <equation id="id81010">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>x</m:mi>
            <m:mo>→</m:mo>
            <m:mi>h</m:mi>
            <m:mo>→</m:mo>
            <m:mi>g</m:mi>
            <m:mo>→</m:mo>
            <m:mi>f</m:mi>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81038">Our design for <m:math overflow="scroll"><m:mi>g</m:mi></m:math> will be a finite impulse response filter with tap coefficients <m:math overflow="scroll"><m:msub><m:mi>g</m:mi><m:mi>i</m:mi></m:msub></m:math>; the mapping from input to output index <m:math overflow="scroll"><m:mi>n</m:mi></m:math> is therefore given by</para>
      <equation id="id81077">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>f</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81134">The error in approximating <m:math overflow="scroll"><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub></m:math> is given by</para>
      <equation id="id81155">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>e</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>f</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>-</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>-</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msub>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81241">The total error magnitude over <m:math overflow="scroll"><m:mi>N</m:mi></m:math> observations is given by</para>
      <equation id="uid11">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>E</m:mi>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>0</m:mn>
              </m:mrow>
              <m:mrow>
                <m:mi>N</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:munderover>
            <m:msubsup>
              <m:mi>e</m:mi>
              <m:mi>n</m:mi>
              <m:mn>2</m:mn>
            </m:msubsup>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>0</m:mn>
              </m:mrow>
              <m:mrow>
                <m:mi>N</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:munderover>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:msup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>g</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:msub>
                  <m:mi>y</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>-</m:mo>
                    <m:mi>i</m:mi>
                  </m:mrow>
                </m:msub>
                <m:mo>-</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mn>2</m:mn>
            </m:msup>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81389">We want to pose this question in terms of error of approximation into a subspace:</para>
      <equation id="id81396">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>E</m:mi>
            <m:mo>=</m:mo>
            <m:msubsup>
              <m:mrow>
                <m:mo>∥</m:mo>
                <m:mi>M</m:mi>
                <m:mi>g</m:mi>
                <m:mo>-</m:mo>
                <m:mi>b</m:mi>
                <m:mo>∥</m:mo>
              </m:mrow>
              <m:mn>2</m:mn>
              <m:mn>2</m:mn>
            </m:msubsup>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81435">By convention, we assume that the values <m:math overflow="scroll"><m:mrow><m:msub><m:mi>g</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>&lt;</m:mo><m:mn>0</m:mn></m:mrow></m:math> (i.e., <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> is the time of the first observation). It can be easily seen that</para>
      <equation id="id81510">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mspace width="3.33333pt"/>
            <m:mi> and </m:mi>
            <m:mspace width="3.33333pt"/>
            <m:mi>b</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>N</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>;</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81598">formulating <m:math overflow="scroll"><m:mi>M</m:mi></m:math> requires a separate study of the sum in <link target-id="uid11"/> for each value of <m:math overflow="scroll"><m:mi>n</m:mi></m:math>. For <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>,</para>
      <equation id="id81641">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mn>0</m:mn>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81729">and so terms <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>≤</m:mo><m:mn>0</m:mn></m:mrow></m:math> can be ignored. For <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>,</para>
      <equation id="id81764">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mn>1</m:mn>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mn>0</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mo>-</m:mo>
                  <m:mi>k</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mn>0</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mn>0</m:mn>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:mn>0</m:mn>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id81995">Similarly, for <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>2</m:mn></m:mrow></m:math>,</para>
      <equation id="id82016">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mn>2</m:mn>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mn>0</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mn>0</m:mn>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:mn>0</m:mn>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id82173">Continuing until <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mi>N</m:mi></m:mrow></m:math>,</para>
      <equation id="id82194">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>k</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>g</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mi>N</m:mi>
                <m:mo>-</m:mo>
                <m:mi>i</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mrow>
              <m:mo>[</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mi>N</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mi>N</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>2</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mi>N</m:mi>
                  <m:mo>-</m:mo>
                  <m:mi>k</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>g</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id82369">The concatenation of these sums as a vector can then be expressed by the matrix-vector product <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mi>g</m:mi></m:mrow></m:math>, where the matrix <m:math overflow="scroll"><m:mi>M</m:mi></m:math> is given by</para>
      <equation id="id82394">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>M</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>0</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mi>N</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mi>N</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>2</m:mn>
                      </m:mrow>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mi>N</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>3</m:mn>
                      </m:mrow>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mi>N</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>4</m:mn>
                      </m:mrow>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋯</m:mo>
                  </m:mtd>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mi>N</m:mi>
                        <m:mo>-</m:mo>
                        <m:mi>k</m:mi>
                      </m:mrow>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id82588">Note that for <m:math overflow="scroll"><m:mi>M</m:mi></m:math> to have linearly independent columns (a condition for uniqueness of the solution to <m:math overflow="scroll"><m:mi>g</m:mi></m:math>) the number of nonzero values of <m:math overflow="scroll"><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub></m:math> must be at least <m:math overflow="scroll"><m:mi>k</m:mi></m:math>. In this case, the solution</para>
      <equation id="id82634">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi>M</m:mi>
              <m:mo>†</m:mo>
            </m:msup>
            <m:mi>b</m:mi>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>M</m:mi>
                  <m:mi>T</m:mi>
                </m:msup>
                <m:mi>M</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mrow>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msup>
            <m:msup>
              <m:mi>M</m:mi>
              <m:mi>T</m:mi>
            </m:msup>
            <m:mi>b</m:mi>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id82692">minimizes the error as established in the Projection Theorem.</para>
    </section>
    <section id="cid5">
      <title>Application: Linear Regression</title>
      <para id="id82708">In linear regression, we are given a set of input/output pairs <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>N</m:mi></m:mrow></m:math>, and we wish to find a linear relationship between inputs and outputs <m:math overflow="scroll"><m:mrow><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mi>a</m:mi><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>+</m:mo><m:mi>b</m:mi></m:mrow></m:math> that minimize the sum of squared errors <m:math overflow="scroll"><m:mrow><m:mi>E</m:mi><m:mo>=</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>N</m:mi></m:msubsup><m:mrow><m:mo>(</m:mo><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mo>-</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:mi>a</m:mi><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>+</m:mo><m:mi>b</m:mi><m:mo>)</m:mo></m:mrow><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. As in previous examples, we seek to pose this minimization problem in terms of the problem considered by the projection theorem: the error <m:math overflow="scroll"><m:mrow><m:mi>E</m:mi><m:mo>=</m:mo><m:msubsup><m:mrow><m:mo>∥</m:mo><m:mi>M</m:mi><m:mi>g</m:mi><m:mo>-</m:mo><m:mi>y</m:mi><m:mo>∥</m:mo></m:mrow><m:mn>2</m:mn><m:mn>2</m:mn></m:msubsup></m:mrow></m:math>, where <m:math overflow="scroll"><m:mi>M</m:mi></m:math> is a matrix, <m:math overflow="scroll"><m:mi>y</m:mi></m:math> is a vector, and <m:math overflow="scroll"><m:mi>g</m:mi></m:math> is the optimization variable vector. One can easily see that the following choice achieves the desired equality:</para>
      <equation id="id82928">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>M</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>1</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>1</m:mn>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>N</m:mi>
                    </m:msub>
                  </m:mtd>
                  <m:mtd>
                    <m:mn>1</m:mn>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>,</m:mo>
            <m:mspace width="3.33333pt"/>
            <m:mi>g</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:mi>a</m:mi>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mi>b</m:mi>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>,</m:mo>
            <m:mspace width="3.33333pt"/>
            <m:mi> and </m:mi>
            <m:mspace width="3.33333pt"/>
            <m:mi>y</m:mi>
            <m:mo>=</m:mo>
            <m:mfenced open="[" close="]">
              <m:mtable>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:mo>⋮</m:mo>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd>
                    <m:msub>
                      <m:mi>y</m:mi>
                      <m:mi>N</m:mi>
                    </m:msub>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id83065">As before, the solution that minimizes the error is given by</para>
      <equation id="id83071">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>M</m:mi>
                  <m:mi>T</m:mi>
                </m:msup>
                <m:mi>M</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mrow>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msup>
            <m:msup>
              <m:mi>M</m:mi>
              <m:mi>T</m:mi>
            </m:msup>
            <m:mi>y</m:mi>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id83121">which exists and is unique as long as <m:math overflow="scroll"><m:mrow><m:mi>G</m:mi><m:mo>=</m:mo><m:msup><m:mi>M</m:mi><m:mi>T</m:mi></m:msup><m:mi>M</m:mi></m:mrow></m:math> is invertible, i.e., as long as <m:math overflow="scroll"><m:mi>M</m:mi></m:math> has linearly independent columns, i.e., as long as not all <m:math overflow="scroll"><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub></m:math> are equal. Now, we see that</para>
      <equation id="uid12">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>T</m:mi>
                  </m:msup>
                  <m:mi>M</m:mi>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mfenced open="[" close="]">
                    <m:mtable>
                      <m:mtr>
                        <m:mtd>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mtd>
                        <m:mtd>
                          <m:mo>⋯</m:mo>
                        </m:mtd>
                        <m:mtd>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>n</m:mi>
                          </m:msub>
                        </m:mtd>
                      </m:mtr>
                      <m:mtr>
                        <m:mtd>
                          <m:mn>1</m:mn>
                        </m:mtd>
                        <m:mtd>
                          <m:mo>⋯</m:mo>
                        </m:mtd>
                        <m:mtd>
                          <m:mn>1</m:mn>
                        </m:mtd>
                      </m:mtr>
                    </m:mtable>
                  </m:mfenced>
                  <m:mfenced open="[" close="]">
                    <m:mtable>
                      <m:mtr>
                        <m:mtd>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mtd>
                        <m:mtd>
                          <m:mn>1</m:mn>
                        </m:mtd>
                      </m:mtr>
                      <m:mtr>
                        <m:mtd>
                          <m:mo>⋮</m:mo>
                        </m:mtd>
                        <m:mtd>
                          <m:mo>⋮</m:mo>
                        </m:mtd>
                      </m:mtr>
                      <m:mtr>
                        <m:mtd>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>n</m:mi>
                          </m:msub>
                        </m:mtd>
                        <m:mtd>
                          <m:mn>1</m:mn>
                        </m:mtd>
                      </m:mtr>
                    </m:mtable>
                  </m:mfenced>
                  <m:mo>=</m:mo>
                  <m:mfenced open="[" close="]">
                    <m:mtable>
                      <m:mtr>
                        <m:mtd>
                          <m:mrow>
                            <m:munderover>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>i</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mi>N</m:mi>
                            </m:munderover>
                            <m:msubsup>
                              <m:mi>x</m:mi>
                              <m:mi>i</m:mi>
                              <m:mn>2</m:mn>
                            </m:msubsup>
                          </m:mrow>
                        </m:mtd>
                        <m:mtd>
                          <m:mrow>
                            <m:munderover>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>i</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mi>n</m:mi>
                            </m:munderover>
                            <m:msub>
                              <m:mi>x</m:mi>
                              <m:mi>i</m:mi>
                            </m:msub>
                          </m:mrow>
                        </m:mtd>
                      </m:mtr>
                      <m:mtr>
                        <m:mtd>
                          <m:mrow>
                            <m:munderover>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>i</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mi>N</m:mi>
                            </m:munderover>
                            <m:msub>
                              <m:mi>x</m:mi>
                              <m:mi>i</m:mi>
                            </m:msub>
                          </m:mrow>
                        </m:mtd>
                        <m:mtd>
                          <m:mi>N</m:mi>
                        </m:mtd>
                      </m:mtr>
                    </m:mtable>
                  </m:mfenced>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>M</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>M</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msup>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mfrac>
                    <m:mfenced open="[" close="]">
                      <m:mtable>
                        <m:mtr>
                          <m:mtd>
                            <m:mi>N</m:mi>
                          </m:mtd>
                          <m:mtd>
                            <m:mrow>
                              <m:mo>-</m:mo>
                              <m:msubsup>
                                <m:mo>∑</m:mo>
                                <m:mrow>
                                  <m:mi>i</m:mi>
                                  <m:mo>=</m:mo>
                                  <m:mn>1</m:mn>
                                </m:mrow>
                                <m:mi>N</m:mi>
                              </m:msubsup>
                              <m:msub>
                                <m:mi>x</m:mi>
                                <m:mi>i</m:mi>
                              </m:msub>
                            </m:mrow>
                          </m:mtd>
                        </m:mtr>
                        <m:mtr>
                          <m:mtd>
                            <m:mrow>
                              <m:mo>-</m:mo>
                              <m:msubsup>
                                <m:mo>∑</m:mo>
                                <m:mrow>
                                  <m:mi>i</m:mi>
                                  <m:mo>=</m:mo>
                                  <m:mn>1</m:mn>
                                </m:mrow>
                                <m:mi>N</m:mi>
                              </m:msubsup>
                              <m:msub>
                                <m:mi>x</m:mi>
                                <m:mi>i</m:mi>
                              </m:msub>
                            </m:mrow>
                          </m:mtd>
                          <m:mtd>
                            <m:mrow>
                              <m:msubsup>
                                <m:mo>∑</m:mo>
                                <m:mrow>
                                  <m:mi>i</m:mi>
                                  <m:mo>=</m:mo>
                                  <m:mn>1</m:mn>
                                </m:mrow>
                                <m:mi>N</m:mi>
                              </m:msubsup>
                              <m:msubsup>
                                <m:mi>x</m:mi>
                                <m:mi>i</m:mi>
                                <m:mn>2</m:mn>
                              </m:msubsup>
                            </m:mrow>
                          </m:mtd>
                        </m:mtr>
                      </m:mtable>
                    </m:mfenced>
                    <m:mrow>
                      <m:mi>N</m:mi>
                      <m:msubsup>
                        <m:mo>∑</m:mo>
                        <m:mrow>
                          <m:mi>i</m:mi>
                          <m:mo>=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mi>N</m:mi>
                      </m:msubsup>
                      <m:msubsup>
                        <m:mi>x</m:mi>
                        <m:mi>i</m:mi>
                        <m:mn>2</m:mn>
                      </m:msubsup>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>n</m:mi>
                          </m:msubsup>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mn>2</m:mn>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msup>
                    <m:mi>M</m:mi>
                    <m:mi>T</m:mi>
                  </m:msup>
                  <m:mi>y</m:mi>
                </m:mrow>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>=</m:mo>
                  <m:mfenced open="[" close="]">
                    <m:mtable>
                      <m:mtr>
                        <m:mtd>
                          <m:mrow>
                            <m:munderover>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>i</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mi>N</m:mi>
                            </m:munderover>
                            <m:msub>
                              <m:mi>x</m:mi>
                              <m:mi>i</m:mi>
                            </m:msub>
                            <m:msub>
                              <m:mi>y</m:mi>
                              <m:mi>i</m:mi>
                            </m:msub>
                          </m:mrow>
                        </m:mtd>
                      </m:mtr>
                      <m:mtr>
                        <m:mtd>
                          <m:mrow>
                            <m:munderover>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>i</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mi>n</m:mi>
                            </m:munderover>
                            <m:msub>
                              <m:mi>y</m:mi>
                              <m:mi>i</m:mi>
                            </m:msub>
                          </m:mrow>
                        </m:mtd>
                      </m:mtr>
                    </m:mtable>
                  </m:mfenced>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id83678">
Collecting these results, we have that</para>
      <equation id="id83683">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mfenced open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mrow>
                        <m:mi>N</m:mi>
                        <m:msubsup>
                          <m:mo>∑</m:mo>
                          <m:mrow>
                            <m:mi>i</m:mi>
                            <m:mo>=</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                          <m:mi>n</m:mi>
                        </m:msubsup>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mi>i</m:mi>
                        </m:msub>
                        <m:msub>
                          <m:mi>y</m:mi>
                          <m:mi>i</m:mi>
                        </m:msub>
                        <m:mo>-</m:mo>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>N</m:mi>
                          </m:msubsup>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>n</m:mi>
                          </m:msubsup>
                          <m:msub>
                            <m:mi>y</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mrow>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>N</m:mi>
                          </m:msubsup>
                          <m:msubsup>
                            <m:mi>x</m:mi>
                            <m:mi>i</m:mi>
                            <m:mn>2</m:mn>
                          </m:msubsup>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>N</m:mi>
                          </m:msubsup>
                          <m:msub>
                            <m:mi>y</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>-</m:mo>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>N</m:mi>
                          </m:msubsup>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msubsup>
                            <m:mo>∑</m:mo>
                            <m:mrow>
                              <m:mi>i</m:mi>
                              <m:mo>=</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>N</m:mi>
                          </m:msubsup>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:msub>
                            <m:mi>y</m:mi>
                            <m:mi>i</m:mi>
                          </m:msub>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mrow>
                <m:mi>N</m:mi>
                <m:msubsup>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:msubsup>
                <m:msubsup>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                  <m:mn>2</m:mn>
                </m:msubsup>
                <m:mo>-</m:mo>
                <m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msubsup>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>N</m:mi>
                    </m:msubsup>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mn>2</m:mn>
                </m:msup>
              </m:mrow>
            </m:mfrac>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
    </section>
    <section id="cid6">
      <title>Least Squares: Rejoinder</title>
      <para id="id84014">We have studied several examples where an optimization problem can be formulated as</para>
      <equation id="id84018">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mover accent="true">
              <m:mi>g</m:mi>
              <m:mo>^</m:mo>
            </m:mover>
            <m:mo>=</m:mo>
            <m:mo form="prefix">arg</m:mo>
            <m:munder>
              <m:mo movablelimits="true" form="prefix">min</m:mo>
              <m:mi>g</m:mi>
            </m:munder>
            <m:msubsup>
              <m:mrow>
                <m:mo>∥</m:mo>
                <m:mi>M</m:mi>
                <m:mi>g</m:mi>
                <m:mo>-</m:mo>
                <m:mi>b</m:mi>
                <m:mo>∥</m:mo>
              </m:mrow>
              <m:mn>2</m:mn>
              <m:mn>2</m:mn>
            </m:msubsup>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id84080">where <m:math overflow="scroll"><m:mi>M</m:mi></m:math> is a matrix and <m:math overflow="scroll"><m:mi>b</m:mi></m:math> and <m:math overflow="scroll"><m:mi>g</m:mi></m:math> are column vectors of appropriate sizes.</para>
      <list id="id84114" display="block" list-type="bulleted">
        <item id="uid13">When the columns of <m:math overflow="scroll"><m:mi>M</m:mi></m:math> are orthonormal (i.e., orthogonal and unit norm), we compute <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>g</m:mi><m:mo>^</m:mo></m:mover><m:mo>=</m:mo><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>b</m:mi></m:mrow></m:math>, i.e., <m:math overflow="scroll"><m:mrow><m:msub><m:mover accent="true"><m:mi>g</m:mi><m:mo>^</m:mo></m:mover><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mrow><m:mo>〈</m:mo><m:msub><m:mi>M</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:mi>b</m:mi><m:mo>〉</m:mo></m:mrow></m:mrow></m:math>, where <m:math overflow="scroll"><m:msub><m:mover accent="true"><m:mi>g</m:mi><m:mo>^</m:mo></m:mover><m:mi>i</m:mi></m:msub></m:math> is the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math> entry of <m:math overflow="scroll"><m:mi>g</m:mi></m:math> and <m:math overflow="scroll"><m:msub><m:mi>M</m:mi><m:mi>i</m:mi></m:msub></m:math> is the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math> column of <m:math overflow="scroll"><m:mi>M</m:mi></m:math>.
</item>
        <item id="uid14">When the columns of <m:math overflow="scroll"><m:mi>M</m:mi></m:math> are linearly independent, we compute <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>g</m:mi><m:mo>^</m:mo></m:mover><m:mo>=</m:mo><m:msup><m:mi>M</m:mi><m:mo>†</m:mo></m:msup><m:mi>b</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>M</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>b</m:mi></m:mrow></m:math>. The Moore-Penrose pseudoinverse <m:math overflow="scroll"><m:mrow><m:msup><m:mi>M</m:mi><m:mo>†</m:mo></m:msup><m:mo>=</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>M</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup></m:mrow></m:math> is well defined because the Gram matrix <m:math overflow="scroll"><m:mrow><m:mi>G</m:mi><m:mo>=</m:mo><m:msup><m:mi>M</m:mi><m:mi>H</m:mi></m:msup><m:mi>M</m:mi></m:mrow></m:math> of a linearly independent set is invertible.
</item>
        <item id="uid15">When the columns of <m:math overflow="scroll"><m:mi>M</m:mi></m:math> are linearly dependent, there exists a vector <m:math overflow="scroll"><m:mrow><m:mi>a</m:mi><m:mo>≠</m:mo><m:mn>0</m:mn></m:mrow></m:math> such that <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mi>a</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>. Thus, if a solution <m:math overflow="scroll"><m:msub><m:mi>g</m:mi><m:mn>0</m:mn></m:msub></m:math> to the optimization exists, then <m:math overflow="scroll"><m:mrow><m:msub><m:mi>g</m:mi><m:mn>0</m:mn></m:msub><m:mo>+</m:mo><m:mi>a</m:mi></m:mrow></m:math> is also a solution: note that <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>∥</m:mo><m:mi>M</m:mi></m:mrow><m:msub><m:mi>g</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>-</m:mo><m:mi>b</m:mi><m:mo>∥</m:mo><m:mo>=</m:mo><m:mo>∥</m:mo><m:mi>M</m:mi></m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mi>g</m:mi><m:mn>0</m:mn></m:msub><m:mo>+</m:mo><m:mi>a</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>-</m:mo><m:mi>b</m:mi><m:mo>∥</m:mo></m:mrow></m:mrow></m:math>, and so we lose uniqueness of the minimizer; in fact, we will have infinitely many solutions to the minimization. However, there are ways to rank the solutions and pick a "favorite", e.g., the solution with the smallest norm. This will be considered later in the course.
</item>
      </list>
    </section>
  </content>
</document>